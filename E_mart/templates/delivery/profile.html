{% extends 'delivery/base.html' %}
{% load static %}
{% block title %}Profile | Delivery Dashboard{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.2/font/bootstrap-icons.css">
<style>
  .profile-header { background: #005546; }
  .status-badge { font-size: 0.85rem; }
  .metric-card { transition: transform 0.2s; }
  .metric-card:hover { transform: translateY(-5px); }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4 px-3 min-vh-100" style="background: #f8f9fa;">
  <!-- Profile Header -->
  <div class="row">
    <div class="col-12">
      <div class="profile-header text-white shadow-lg border-0 rounded-4">
        <div class="card-body p-4 p-md-5 text-center text-md-start">
          <div class="row align-items-center">
            <div class="col-md-3 col-12 text-center mb-4 mb-md-0">
              <div class="avatar-container position-relative d-inline-block">
                <i class="bi bi-person" style="font-size: 100px;"></i>
                <div class="position-absolute bottom-0 end-0 bg-success rounded-circle p-2 border border-white shadow-sm">
                  <i class="bi bi-check-circle-fill text-white"></i>
                </div>
              </div>
            </div>
            <div class="col-md-9 ps-md-4">
              <h2 class="fw-bold mb-1">{{ delivery_person.user.get_full_name|default:delivery_person.user.username }}</h2>
              <p class="fs-5 fw-semibold text-success mb-2">Delivery Executive</p>
              <div class="row g-3 mb-3">
                <div class="col-auto">
                  <span class="badge bg-light text-dark px-3 py-2 fs-6 fw-semibold">
                    {% if delivery_person.is_available %}
                      <i class="bi bi-circle-fill text-success me-1"></i> Available
                    {% else %}
                      <i class="bi bi-circle-fill text-danger me-1"></i> Offline
                    {% endif %}
                  </span>
                </div>
                <div class="col-auto">
                  <span class="badge bg-primary px-3 py-2 fs-6">
                    <i class="bi bi-credit-card me-1"></i>â‚¹{{ delivery_person.amount|default:"0.00" }}
                  </span>
                </div>
                {% if delivery_person.user.role == 3 %}
                  <div class="col-auto">
                    <span class="badge bg-warning text-dark px-3 py-2 fs-6">Verified Partner</span>
                  </div>
                {% endif %}
              </div>
              <p class="mb-2 opacity-90">{{ delivery_person.user.phone_number }}</p>
              <small class="opacity-75">Joined: {{ delivery_person.user.date_joined|date:"M Y" }}</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4 mt-4">
    <!-- Quick Stats -->
    <div class="col-lg-3 col-md-6">
      <div class="p-4 rounded bg-light h-100 metric-card shadow-sm border-0">
        <div class="card-body text-center p-4">
          <i class="bi bi-truck-front display-4 text-primary mb-3"></i>
          <h3 class="fw-bold text-primary">{{data.deliveries_count}}</h3>
          <p class="mb-0 text-muted">Total Deliveries</p>
        </div>
      </div>
    </div>

    <div class="col-lg-3 col-md-6">
      <div class="p-4 rounded bg-light h-100 metric-card shadow-sm border-0">
        <div class="card-body text-center p-4">
          <i class="bi bi-box-arrow-in-down display-4 text-primary mb-3"></i>
          <h3 class="fw-bold text-primary">{{data.pickups_count}}</h3>
          <p class="mb-0 text-muted">Total Pickups</p>
        </div>
      </div>
    </div>
    <div class="col-lg-3 col-md-6">
      <div class="p-4 rounded bg-light h-100 metric-card shadow-sm border-0">
        <div class="card-body text-center p-4">
          <i class="bi bi-check-circle display-4 text-success mb-3"></i>
          <h3 class="fw-bold text-success">{{data.complete_count}}</h3>
          <p class="mb-0 text-muted">Completed</p>
        </div>
      </div>
    </div>
    <div class="col-lg-3 col-md-6">
      <div class="p-4 rounded bg-light h-100 metric-card shadow-sm border-0">
        <div class="card-body text-center p-4">
          <i class="bi bi-clock display-4 text-warning mb-3"></i>
          <h3 class="fw-bold text-warning">{{data.pending_count}}</h3>
          <p class="mb-0 text-muted">Pending</p>
        </div>
      </div>
    </div>
    {% comment %} <div class="col-lg-3 col-md-6">
      <div class="p-4 rounded bg-light h-100 metric-card shadow-sm border-0">
        <div class="card-body text-center p-4">
          <i class="bi bi-star-fill display-4 text-info mb-3"></i>
          <h3 class="fw-bold text-info">4.9</h3>
          <p class="mb-0 text-muted">Rating</p>
        </div>
      </div>
    </div> {% endcomment %}
  </div>

  <!-- Profile Details -->
  <div class="row g-4 mt-4">
    <div class="col-lg-8">
      <div class="p-4 shadow-sm border-0">
        <div class="card-header bg-white border-0 pb-0">
          <h5 class="fw-bold mb-3"><i class="bi bi-person-lines-fill me-2"></i>Profile Details</h5>
        </div>
        <div class="card-body pt-0">
          <div class="row g-4">
            <div class="col-md-6">
              <label class="form-label fw-semibold">Email</label>
              <p class="form-control-plaintext p-3 bg-light rounded">{{ delivery_person.user.email }}</p>
            </div>
            <div class="col-md-6">
              <label class="form-label fw-semibold">Phone</label>
              <p class="form-control-plaintext p-3 bg-light rounded">{{ delivery_person.user.phone_number }}</p>
            </div>
            <div class="col-12">
              <label class="form-label fw-semibold">Primary Address</label>
              <p class="form-control-plaintext p-3 bg-light rounded">{{ delivery_person.user.address|default:"Not provided" }}</p>
            </div>
            <div class="col-12">
              <label class="form-label fw-semibold">Alternate Address</label>
              <p class="form-control-plaintext p-3 bg-light rounded">{{ delivery_person.user.optional_address|default:"Not provided" }}</p>
            </div>
            <div class="col-md-6">
              <label class="form-label fw-semibold">Status</label>
              <span class="badge fs-6 px-3 py-2 {% if delivery_person.is_active %}bg-success{% else %}bg-secondary{% endif %}">
                {% if delivery_person.is_active %}Active{% else %}Inactive{% endif %}
              </span>
            </div>
            <div class="col-md-6">
              <label class="form-label fw-semibold">Availability</label>
              <span class="badge fs-6 px-3 py-2 {% if delivery_person.is_available %}bg-success{% else %}bg-danger{% endif %}">
                {% if delivery_person.is_available %}Online{% else %}Offline{% endif %}
              </span>
            </div>
          </div>
          <hr class="my-4">
          <div class="d-flex gap-3">
            <a href="#" class="btn btn-primary btn-lg">
              <i class="bi bi-pencil me-2"></i>Edit Profile
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="col-lg-4">
      <div class="p-4 shadow-sm border-0 h-100">
        <div class="card-header bg-white border-0 pb-0">
          <h6 class="fw-bold mb-3"><i class="bi bi-lightning-charge me-2 text-primary"></i>Quick Actions</h6>
        </div>
        <div class="card-body pt-0">
          <div class="list-group list-group-flush">
            <a href="/deliveries/" class="list-group-item list-group-item-action d-flex align-items-center p-3 border-0">
              <i class="bi bi-truck fs-4 text-primary me-3"></i>
              <div>
                <div class="fw-semibold">View Deliveries</div>
                <small class="text-muted">Manage active orders</small>
              </div>
            </a>
            <a href="/pickups/" class="list-group-item list-group-item-action d-flex align-items-center p-3 border-0">
              <i class="bi bi-bag-check fs-4 text-success me-3"></i>
              <div>
                <div class="fw-semibold">Pickup Orders</div>
                <small class="text-muted">Customer pickups</small>
              </div>
            </a>
            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center p-3 border-0">
              <i class="bi bi-calendar-check fs-4 text-info me-3"></i>
              <div>
                <div class="fw-semibold">Schedule</div>
                <small class="text-muted">Working hours</small>
              </div>
            </a>
            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center p-3 border-0">
              <i class="bi bi-wallet2 fs-4 text-warning me-3"></i>
              <div>
                <div class="fw-semibold">Payouts</div>
                <small class="text-muted">Earnings history</small>
              </div>
            </a>
            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center p-3 border-0">
              <i class="bi bi-chat-dots fs-4 text-danger me-3"></i>
              <div>
                <div class="fw-semibold">Support</div>
                <small class="text-muted">Get help</small>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
