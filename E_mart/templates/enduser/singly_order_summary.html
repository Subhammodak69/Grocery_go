{% extends "enduser/base.html" %}
{% load static %}
{% block title %}Order | Grocery_go{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/order_summary_singly.css' %}">
{% endblock %}
{% block extra_js %}
<script src="{% static 'js/order_summary_singly.js' %}"></script>
{% endblock %}

{% block content %}
<div class="container py-4">
  <h2 class="mb-4 text-center">Your Order Summary</h2>

  <form id="order-summary-form" class="d-flex flex-column flex-md-row justify-content-between gap-4 bg-white rounded p-4 shadow-sm">
    
    <!-- Product Details Section -->
    <div class="mx-auto">
      <div class="cart-item border rounded p-3 text-center mb-4 mb-md-0" style="max-height:300px">
        <img src="{% static data.image %}" alt="Product Image" class="rounded mb-3" style="height:200px; width: 100%;">
      </div>
      <h5 class="fw-semibold mb-3 d-flex gap-3"><p class="text-gray fs-20">Product Name:</p>{{ data.name }}</h5>

      <div class="d-flex flex-wrap justify-content-center gap-3">
        <div>
          <label for="quantity" class="form-label d-block">Quantity:</label>
          <p>{{data.quantity}}</p>
        </div>

        <div>
          <label for="size" class="form-label d-block">Size:</label>
          <p>{{data.size}}</p>
        </div>
      </div>
    </div>

    <input type="hidden" id="product_id" name="product_id" value="{{ product_item.id }}">

    <!-- Payment and User Details Section -->
    <div style="flex: 1;max-width:600px;">
      <div class="border rounded p-3 bg-light mb-4">
        <h4>Payable Amount</h4>
        <div class="d-flex justify-content-between">
          <span>Product Price</span>
          <span class="text-secondary">${{ data.price|floatformat:2 }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <span>Discount</span>
          <span class="text-danger">- ${{ product_item.discount_amount|floatformat:2 }}</span>
        </div>
        <hr>
        <div class="d-flex justify-content-between fw-bold text-success">
          <span>Total</span>
          <span>${{ product_item.total|floatformat:2 }}</span>
        </div>
      </div>

      <div class="border rounded p-3 bg-light mb-3">
        <h4>User Details</h4>
        <p><strong>Full Name:</strong> {{ user.get_full_name }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        {% if user.phone %}
        <p><strong>Phone:</strong> {{ user.phone }}</p>
        {% endif %}
        {% if user.address %}
        <p><strong>Address:</strong> {{ user.address }}</p>
        {% endif %}
      </div>

      <label for="delivery-address" class="form-label fw-semibold">Delivery Address</label>
      <textarea id="delivery-address" name="address" class="form-control mb-3" placeholder="Enter delivery address manually..." required></textarea>

      <button type="button" class="btn btn-outline-secondary btn-sm mb-3" onclick="getCurrentLocation()">
        Use My Current Location
      </button>

      <button type="submit" class="btn btn-primary w-100">Place Order</button>
    </div>
  </form>
</div>
{% endblock %}
